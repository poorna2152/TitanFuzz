--- Generating for jnp.cov ---
------ | seeds | = 1 -----
--- seeds_for_generation : 1 ---
--- Round : 0 ---
--- New Valid : 2 using 13.645256757736206s generation, 0.005700349807739258s validation ---
--- Round : 1 ---
--- New Valid : 0 using 10.77968430519104s generation, 0.0015213489532470703s validation ---
--- Round : 2 ---
--- New Valid : 0 using 15.50696611404419s generation, 0.2620515823364258s validation ---
--- Round : 3 ---
--- New Valid : 0 using 11.915623903274536s generation, 0.0015022754669189453s validation ---
--- Round : 4 ---
--- New Valid : 0 using 11.670064926147461s generation, 0s validation ---
--- Round : 5 ---
--- New Valid : 0 using 20.255305528640747s generation, 0s validation ---
--- Round : 6 ---
--- New Valid : 6 using 12.352097988128662s generation, 0.26059746742248535s validation ---
--- Round : 7 ---
--- New Valid : 0 using 11.371707677841187s generation, 0s validation ---
--- Round : 8 ---
--- New Valid : 0 using 12.172556161880493s generation, 0.2555239200592041s validation ---
Highest Order: 1
----- 
 
import jax
import jax.numpy as jnp
import json
(N, M) = (512, 512)
key = jax.random.PRNGKey(0)
data = jax.random.uniform(key, (N, M), dtype=jnp.float32)

def covariance(data):
    cov = jnp.cov(data)
    cov = (cov / (N * M))
    cov = ((cov - cov.mean(0)) / (N * M))
    cov = (cov / (cov.std(0) + 1e-08))
    return cov

def generate_metadata(*args, func=None):
    args_meta = []
    for x in args:
        shape = list(x.shape)
        dtype = ('matrix' if (len(shape) > 1) else 'vector')
        args_meta.append({'type': dtype, 'shape': shape})
    metadata = {'args': args_meta}
    if (func is not None):
        output_shape_dtype = jax.eval_shape(func, *args)
        metadata['output'] = {'type': ('matrix' if (len(output_shape_dtype.shape) > 1) else 'vector'), 'shape': list(output_shape_dtype.shape), 'type': ('matrix' if (len(output_shape_dtype.shape) > 1) else 'vector')}
    filename = Path(__file__).name.replace('.py', '')
    pathname = (((filename + '/') + filename) + '.json')
    with open(pathname, 'w') as f:
        json.dump(metadata, f, indent=2)
 
 ----- 
8 valid outputs using 119.66926336288452s generation, 0.7868969440460205s validation
39 generated: 2 exceptions 21 duplicated 0 crashes 0 timeouts 8 notarget
--- Generating for jnp.dot ---
------ | seeds | = 1 -----
--- seeds_for_generation : 1 ---
--- Round : 0 ---
--- New Valid : 8 using 9.713441133499146s generation, 0.010192155838012695s validation ---
--- Round : 1 ---
--- New Valid : 4 using 5.488971471786499s generation, 0.006356000900268555s validation ---
--- Round : 2 ---
--- New Valid : 7 using 6.668118715286255s generation, 0.009181737899780273s validation ---
--- Round : 3 ---
--- New Valid : 1 using 5.858358860015869s generation, 0.0019516944885253906s validation ---
--- Round : 4 ---
--- New Valid : 0 using 7.576153516769409s generation, 0.0009250640869140625s validation ---
--- Round : 5 ---
--- New Valid : 9 using 11.652357578277588s generation, 0.23297357559204102s validation ---
--- Round : 6 ---
--- New Valid : 1 using 7.233301162719727s generation, 0.002054452896118164s validation ---
--- Round : 7 ---
--- New Valid : 4 using 5.586717844009399s generation, 0.005127668380737305s validation ---
--- Round : 8 ---
--- New Valid : 0 using 5.492265939712524s generation, 0.0026712417602539062s validation ---
--- Round : 9 ---
--- New Valid : 3 using 11.585612058639526s generation, 0.22616028785705566s validation ---
--- Round : 10 ---
--- New Valid : 1 using 6.244009971618652s generation, 0.0020101070404052734s validation ---
--- Round : 11 ---
--- New Valid : 0 using 11.392624139785767s generation, 0.002203702926635742s validation ---
--- Round : 12 ---
--- New Valid : 0 using 19.69576597213745s generation, 0s validation ---
--- Round : 13 ---
--- New Valid : 2 using 19.09032106399536s generation, 0.22402024269104004s validation ---
Highest Order: 4
----- 
 
import jax
import jax.numpy as jnp
import json
N = 256
key = jax.random.PRNGKey(0)
r = jax.random.uniform(key, (N,), dtype=jnp.float32)

def durbin(r):
    "Toeplitz system solver (Durbin's algorithm)."
    y = jnp.zeros_like(r)
    beta = 1.0
    alpha = (- r[0])
    y = y.at[0].set(alpha)
    for k in range(1, N):
        beta = (beta * (1.0 - (alpha ** 2)))
        sum_ = ((jnp.dot(y, y) / (jnp.dot(y, y) * ((beta * jnp.dot(alpha, beta)) - jnp.dot((alpha * r), (beta * r))))) / N)
        y = y.at[0].set((sum_ / beta))
        alpha = (alpha / ((beta * jnp.dot(y, y)) / beta))
 
 ----- 
40 valid outputs using 133.27801942825317s generation, 0.7258279323577881s validation
93 generated: 5 exceptions 46 duplicated 0 crashes 0 timeouts 2 notarget
--- Generating for jnp.matmul ---
------ | seeds | = 12 -----
--- seeds_for_generation : 12 ---
--- Round : 0 ---
--- New Valid : 4 using 17.41632103919983s generation, 0.008280754089355469s validation ---
--- Round : 1 ---
--- New Valid : 0 using 12.987760305404663s generation, 0.001678466796875s validation ---
--- Round : 2 ---
--- New Valid : 3 using 12.988399505615234s generation, 0.7268342971801758s validation ---
--- Round : 3 ---
--- New Valid : 0 using 10.909717559814453s generation, 0.0009465217590332031s validation ---
--- Round : 4 ---
--- New Valid : 0 using 13.884496927261353s generation, 0s validation ---
--- Round : 5 ---
--- New Valid : 0 using 23.942049264907837s generation, 0s validation ---
--- Round : 6 ---
--- New Valid : 2 using 13.26262640953064s generation, 0.3713951110839844s validation ---
--- Round : 7 ---
--- New Valid : 0 using 9.837657451629639s generation, 0.20273160934448242s validation ---
--- Round : 8 ---
--- New Valid : 1 using 13.281381368637085s generation, 0.7167205810546875s validation ---
Highest Order: 3
----- 
 
import logging
import jax
import jax.numpy as jnp
import numpy as np
import json

def get_stablehlo_asm(module_str: str) -> str:
    'Returns a pretty-printed StableHLO module with truncated large constants.'
    with jax_mlir.make_ir_context():
        stablehlo_module = ir.Module.parse(module_str, context=jax_mlir.make_ir_context())
key = jax.random.PRNGKey(0)
(M, K, N) = (512, 256, 128)
A = jax.random.normal(key, (M, N), dtype=jnp.float32)
X = jax.random.uniform(key, (M, K), dtype=jnp.float32)
B = jax.random.uniform(key, (K, N), dtype=jnp.float32)
C = jax.random.uniform(key, (K,), dtype=jnp.float32)
D = jax.random.uniform(key, (K, N), dtype=jnp.float32)

def gemm(A, B):
    C = jnp.matmul(A, B)
    C.flatten = (lambda _: jnp.reshape(C, ((- 1), 1)))
    C *= (1.0 / jnp.linalg.norm(A, axis=(- 1)))

def generate_metadata(*args, func=None):
    args_meta = []
    for x in args:
        shape = list(x.shape)
        dtype = ('matrix' if (len(shape) > 1) else 'vector')
        args_meta.append({'type': dtype, 'shape': shape})
    metadata = {'args': args_meta}
    if (func is not None):
        output_shape_dtype = jax.eval_shape(func, *args)
        metadata['output'] = {'type': ('matrix' if (len(output_shape_dtype.shape) > 1) else 'vector'), 'shape': list(output_shape_dtype.shape), 'type': ('matrix' if (len(output_shape_dtype.shape) > 1) else 'vector')}
    filename = Path(__file__).name.replace('.py', '')
    pathname = (((filename + '/') + filename) + '.json')
    with open(pathname, 'w') as f:
        json.dump(metadata, f, indent=2)
 
 ----- 
10 valid outputs using 128.51040983200073s generation, 2.0285873413085938s validation
49 generated: 3 exceptions 33 duplicated 0 crashes 0 timeouts 3 notarget
--- Generating for jnp.mean ---
------ | seeds | = 1 -----
--- seeds_for_generation : 1 ---
--- Round : 0 ---
--- New Valid : 1 using 14.051107406616211s generation, 0.0025603771209716797s validation ---
--- Round : 1 ---
--- New Valid : 0 using 13.641427278518677s generation, 0s validation ---
--- Round : 2 ---
--- New Valid : 4 using 13.892521858215332s generation, 0.267270565032959s validation ---
--- Round : 3 ---
--- New Valid : 0 using 9.191240787506104s generation, 0.0011768341064453125s validation ---
--- Round : 4 ---
--- New Valid : 0 using 21.063496112823486s generation, 0s validation ---
--- Round : 5 ---
--- New Valid : 0 using 11.788234233856201s generation, 0s validation ---
--- Round : 6 ---
--- New Valid : 1 using 11.954115867614746s generation, 0.2490406036376953s validation ---
--- Round : 7 ---
--- New Valid : 1 using 12.045463562011719s generation, 0.001989603042602539s validation ---
--- Round : 8 ---
--- New Valid : 5 using 9.270587682723999s generation, 0.0077266693115234375s validation ---
--- Round : 9 ---
--- New Valid : 1 using 8.490541934967041s generation, 0.1644287109375s validation ---
Highest Order: 2
----- 
 
import jax
import jax.numpy as jnp
import json
(N, M) = (512, 512)
key = jax.random.PRNGKey(0)
data = jax.random.uniform(key, (N, M), dtype=jnp.float32)

def correlation(data):
    'Performs the correlation kernel.'
    mean = jnp.mean(data, axis=0)
    variance = (jnp.mean(data) - mean)
    stddev = jnp.std(data, axis=0)
    normalized_data = ((data - mean) / stddev)
    corr = (jnp.matmul(normalized_data.T, normalized_data) / N)
    return corr

def generate_metadata(*args, func=None):
    args_meta = []
    for x in args:
        shape = list(x.shape)
        dtype = ('matrix' if (len(shape) > 1) else 'vector')
        attrs = {'shape': shape, 'dtype': dtype}
        attrs['name'] = func(x).__name__
        args_meta.append(attrs)
    metadata = json.dumps(args_meta, indent=2)
    return metadata

def save_metadata(pathname, metadata):
    with open(pathname, 'w') as f:
        json.dump(metadata, f, indent=2)
 
 ----- 
13 valid outputs using 125.38873672485352s generation, 0.6941933631896973s validation
38 generated: 0 exceptions 22 duplicated 0 crashes 0 timeouts 3 notarget
Did not find jnp.minimum in list of valid seed apis
--- Generating for jnp.roll ---
------ | seeds | = 5 -----
--- seeds_for_generation : 5 ---
--- Round : 0 ---
--- New Valid : 1 using 6.926068544387817s generation, 0.0032906532287597656s validation ---
--- Round : 1 ---
--- New Valid : 0 using 9.712541103363037s generation, 0.0023021697998046875s validation ---
--- Round : 2 ---
--- New Valid : 1 using 11.123608827590942s generation, 0.2991516590118408s validation ---
--- Round : 3 ---
--- New Valid : 0 using 5.947164058685303s generation, 0.0012900829315185547s validation ---
--- Round : 4 ---
--- New Valid : 0 using 16.75061869621277s generation, 0s validation ---
--- Round : 5 ---
--- New Valid : 4 using 11.024178266525269s generation, 0.25779151916503906s validation ---
--- Round : 6 ---
--- New Valid : 2 using 11.285152912139893s generation, 0.0051457881927490234s validation ---
--- Round : 7 ---
--- New Valid : 0 using 7.9070799350738525s generation, 0s validation ---
--- Round : 8 ---
--- New Valid : 0 using 11.628007888793945s generation, 0s validation ---
--- Round : 9 ---
--- New Valid : 0 using 18.25313138961792s generation, 0s validation ---
--- Round : 10 ---
--- New Valid : 2 using 19.033828258514404s generation, 0.2539501190185547s validation ---
Highest Order: 2
----- 
 
import jax
import jax.numpy as jnp
N = 512
T = 10
key = jax.random.PRNGKey(0)
u = jax.random.uniform(key, (N, N), dtype=jnp.float32)

@jax.jit
def adi(u):
    'Performs the adi kernel.'
    for t in range(T):
        u_new = ((((jnp.roll(u, (- 3), axis=0) + jnp.roll(u, (- 1), axis=0)) + jnp.roll(u, 1, axis=1)) + jnp.roll(u, (- 1), axis=1)) / 4)
        u = u_new
    return u

def dij(u):
    'Performs the dij kernel.'
 
 ----- 
10 valid outputs using 129.59137988090515s generation, 0.8229219913482666s validation
49 generated: 2 exceptions 32 duplicated 0 crashes 0 timeouts 5 notarget
--- Generating for jnp.transpose ---
------ | seeds | = 1 -----
--- seeds_for_generation : 1 ---
--- Round : 0 ---
--- New Valid : 2 using 16.780109643936157s generation, 0.004719972610473633s validation ---
--- Round : 1 ---
--- New Valid : 0 using 14.992089748382568s generation, 0.0030982494354248047s validation ---
--- Round : 2 ---
--- New Valid : 1 using 13.209652662277222s generation, 0.3710975646972656s validation ---
--- Round : 3 ---
--- New Valid : 0 using 9.261157035827637s generation, 0.0009386539459228516s validation ---
--- Round : 4 ---
--- New Valid : 0 using 22.489574670791626s generation, 0s validation ---
--- Round : 5 ---
--- New Valid : 0 using 11.65972089767456s generation, 0s validation ---
--- Round : 6 ---
--- New Valid : 2 using 18.053653240203857s generation, 0.3679323196411133s validation ---
--- Round : 7 ---
--- New Valid : 0 using 13.288191318511963s generation, 0.004260540008544922s validation ---
Highest Order: 2
----- 
 
import jax
import jax.numpy as jnp
import json
N = 512
key = jax.random.PRNGKey(0)
A = jax.random.uniform(key, (N, N), dtype=jnp.float32)
y1 = jax.random.uniform(key, (N,), dtype=jnp.float32)
y2 = jax.random.uniform(key, (N,), dtype=jnp.float32)

def mvt(A, y1, y2):
    'Performs the mvt kernel.'
    x1 = jnp.zeros((N,), dtype=jnp.float32)
    x2 = jax.random.uniform((N,), dtype=jnp.float32)
    x1 = (x1 + jnp.matmul(jnp.transpose(A), y1))
    x2 = (x2 + jnp.matmul(A, y2))
    x = (x1 + x2)
    return x

def generate_metadata(*args, func=None):
    args_meta = []
    for x in args:
        shape = list(x.shape)
        dtype = ('matrix' if (len(shape) > 1) else 'vector')
        args_meta.append({'type': dtype, 'shape': shape})
    metadata = {'args': args_meta}
    if (func is not None):
        output_shape_dtype = jax.eval_shape(func, *args)
        metadata['output'] = {'type': ('matrix' if (len(output_shape_dtype.shape) > 1) else 'vector'), 'shape': list(output_shape_dtype.shape), 'type': ('matrix' if (len(output_shape_dtype.shape) > 1) else 'vector')}
    filename = Path(__file__).name.replace('.py', '')
    pathname = (((filename + '/') + filename) + '.json')
    with open(pathname, 'w') as f:
        json.dump(metadata, f, indent=2)
 
 ----- 
5 valid outputs using 119.73414921760559s generation, 0.7520473003387451s validation
29 generated: 4 exceptions 17 duplicated 0 crashes 0 timeouts 3 notarget
--- Generating for jax.scipy.signal.convolve2d ---
------ | seeds | = 1 -----
--- seeds_for_generation : 1 ---
--- Round : 0 ---
--- New Valid : 0 using 16.68201994895935s generation, 0s validation ---
--- Round : 1 ---
--- New Valid : 0 using 19.593761682510376s generation, 0s validation ---
--- Round : 2 ---
--- New Valid : 1 using 14.323137283325195s generation, 0.25750303268432617s validation ---
--- Round : 3 ---
--- New Valid : 0 using 9.411191463470459s generation, 0.0009613037109375s validation ---
--- Round : 4 ---
--- New Valid : 0 using 18.0009663105011s generation, 0s validation ---
--- Round : 5 ---
--- New Valid : 0 using 15.38747525215149s generation, 0s validation ---
--- Round : 6 ---
--- New Valid : 1 using 13.195067405700684s generation, 0.25293493270874023s validation ---
--- Round : 7 ---
--- New Valid : 0 using 5.704933166503906s generation, 0s validation ---
--- Round : 8 ---
--- New Valid : 0 using 11.012620210647583s generation, 0s validation ---
Highest Order: 2
----- 
 
import jax
import jax.numpy as jnp
import json
(W, H) = (256, 256)
key = jax.random.PRNGKey(0)
img = jax.random.uniform(key, (H, W), dtype=jnp.float32)

def deriche(img):
    'Simple edge detection filter (deriche).'
    Kx = jnp.array([[1, 0, (- 1)], [2, 0, (- 2)], [1, 0, (- 1)]], dtype=jnp.float32)
    Ky = jnp.array([[1, 2, 1], [0, 0, 0], [(- 1), (- 2), (- 1)]], dtype=jnp.float32)
    gx = jax.scipy.signal.convolve2d(img, Kx, mode='same')
    gy = jax.scipy.signal.convolve2d(img, Ky, mode='same')
 
 ----- 
2 valid outputs using 123.31117272377014s generation, 0.5113992691040039s validation
6 generated: 0 exceptions 3 duplicated 0 crashes 0 timeouts 1 notarget
--- Generating for jax.scipy.sparse.linalg.bicgstab ---
------ | seeds | = 1 -----
--- seeds_for_generation : 1 ---
--- Round : 0 ---
--- New Valid : 3 using 6.265034198760986s generation, 0.005252838134765625s validation ---
--- Round : 1 ---
--- New Valid : 0 using 9.264019966125488s generation, 0.002383708953857422s validation ---
--- Round : 2 ---
--- New Valid : 1 using 14.136805534362793s generation, 0.4129610061645508s validation ---
--- Round : 3 ---
--- New Valid : 0 using 5.551884889602661s generation, 0.0009245872497558594s validation ---
--- Round : 4 ---
--- New Valid : 0 using 16.613951444625854s generation, 0s validation ---
--- Round : 5 ---
--- New Valid : 0 using 11.369168043136597s generation, 0s validation ---
--- Round : 6 ---
--- New Valid : 2 using 10.83115005493164s generation, 0.40882110595703125s validation ---
--- Round : 7 ---
--- New Valid : 4 using 8.800502300262451s generation, 0.0057220458984375s validation ---
--- Round : 8 ---
--- New Valid : 4 using 9.185365438461304s generation, 0.006709575653076172s validation ---
--- Round : 9 ---
--- New Valid : 1 using 7.367305517196655s generation, 0.0032432079315185547s validation ---
--- Round : 10 ---
--- New Valid : 6 using 5.250364303588867s generation, 0.3724377155303955s validation ---
--- Round : 11 ---
--- New Valid : 2 using 5.585197925567627s generation, 0.003571033477783203s validation ---
--- Round : 12 ---
--- New Valid : 2 using 4.883255481719971s generation, 0.0038650035858154297s validation ---
--- Round : 13 ---
--- New Valid : 1 using 20.56594204902649s generation, 0.0018613338470458984s validation ---
Highest Order: 4
----- 
 
import jax
import jax.numpy as jnp
import json
(M, N) = (512, 512)
key = jax.random.PRNGKey(0)
A = jax.random.uniform(key, (M, N), dtype=jnp.float32)
b = jax.random.uniform(key, (N,), dtype=jnp.float32)
x = jnp.zeros((M,), dtype=jnp.float32)

def bicg(A, b, x):
    s = jax.scipy.sparse.linalg.bicgstab(A.dot(x), b, check_finite=False)
    return jnp.real(s)

def lin_comb_lsq(A, b, x):
    (m, n) = A.shape
    A = jax.scipy.sparse.spdiags(A, 0, m, n, format=jnp.sp)
    s = jnp.dot(s, j)
    s = jnp.linalg.solve(A, s)
    s = jax.scipy.sparse.linalg.spdiags(s, 0, m, n, format=jnp.sp)
    b = jnp.dot(s, jnp.conj(b))
    s = jnp.linalg.solve(A, b)
 
 ----- 
26 valid outputs using 135.66994714736938s generation, 1.2277531623840332s validation
51 generated: 3 exceptions 19 duplicated 0 crashes 0 timeouts 3 notarget
